<!-- components/user-list/user-list.component.html -->
<div class="container mt-4">
    <h2>Users List</h2>
  
    <div *ngIf="loading" class="text-center">
      <p>Loading users...</p>
    </div>
  
    <div *ngIf="error" class="alert alert-danger">
      {{ error }}
    </div>
  
    <table *ngIf="!loading && users.length > 0" class="table table-striped">
      <thead>
        <tr>
          <th>First Name</th>
          <th>Last Name</th>
          <th>Email</th>
          <th>Permissions</th>
          <th>Actions</th> 
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of users">
          <td>{{ user.firstName }}</td>
          <td>{{ user.lastName }}</td>
          <td>
            <a *ngIf="userPermissions.includes('can_update_users')" 
               [routerLink]="['/users/edit', user.id]"
               class="email-link">{{ user.email }}</a>
            <span *ngIf="!userPermissions.includes('can_update_users')">{{ user.email }}</span> 
          </td>
          <td>
            <!-- <span *ngFor="let permission of user.permissions" class="badge bg-primary me-1">
              {{ permission }}
            </span> -->
              <span *ngFor="let permission of getDisplayedPermissions(user.permissions); let i = index" class="badge bg-primary me-1">
                {{ permission }}
              </span>
              
              <div *ngIf="user.permissions.length > 5">
                <span *ngFor="let permission of getOverflowPermissions(user.permissions)" class="badge bg-primary me-1">
                  {{ permission }}
                </span>
              </div>
          </td>
          <td>
            <button 
              class="btn btn-danger btn-sm" 
              [disabled]="!userPermissions.includes('can_delete_users')"
              (click)="deleteUser(user.id!)">
              Delete
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  
    <div *ngIf="!loading && users.length === 0" class="alert alert-info">
      No users found.
    </div>
  </div>